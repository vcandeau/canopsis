#!/bin/bash

NAME="python"
VERSION=2.7.1
RELEASE=0
DESCRIPTION=""
REQUIRES="canohome pkgmgr"

function pre_install(){
	echo "Pre-install $NAME $VERSION-$RELEASE ..."
	tmp_nb=$(date +%N)
	path_file="$PREFIX/lib/python2.7/site-packages/easy-install.pth"
	tmp_file="$PREFIX/tmp/easy-install.pth.$tmp_nb"
	patch="$PREFIX/tmp/easy-install.pth.patch.$tmp_nb"
	if [ -e "$path_file" ]; then
		launch_cmd "cp $path_file $tmp_file"
		check_code $? "Error during backup easy-install.pt file"
	fi
}

function post_install(){
	echo "Post-install $NAME $VERSION-$RELEASE ..."
	if [[ -e "$path_file" && "$tmp_file" ]]; then
		launch_cmd "diff $path_file $tmp_file > $patch"
		check_code $? "Error during diff command"
		launch_cmd "patch $path_file $path"
		check_code $? "Error during patch command"
	fi
}

function pre_remove(){
	echo "Pre-remove $NAME $VERSION-$RELEASE ..."
	check_code $?
}

function post_remove(){
	echo "Post-remove $NAME $VERSION-$RELEASE ..."
	check_code $?
}

function pre_update(){
	echo "Pre-update $NAME $VERSION-$RELEASE ..."
	check_code $?
}

function post_update(){
	echo "Post-update $NAME $VERSION-$RELEASE ..."
	check_code $?
}

function purge(){
	echo "Purge $NAME $VERSION-$RELEASE ..."
	check_code $?
}
