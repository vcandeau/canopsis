#!/bin/bash

NAME="python"
VERSION=2.7.1
RELEASE=0
DESCRIPTION=""
REQUIRES="canohome pkgmgr"

function pre_install(){
	echo "Pre-install $NAME $VERSION-$RELEASE ..."
	path_file="$PREFIX/lib/python2.7/site-packages/easy-install.pth"
	if [ -e "$path_file" ]; then
		tmp_file=$(mktemp --tmpdir="$PREFIX/tmp")
		launch_cmd 1 cp $path_file $tmp_file
		patch="$tmp_file.patch"
	fi
}

function post_install(){
	echo "Post-install $NAME $VERSION-$RELEASE ..."
	if [[ -e "$path_file" && -e "$tmp_file" ]]; then
		launch_cmd 1 diff $path_file $tmp_file > $patch
		launch_cmd 1 patch $path_file $path
		launch_cmd 1 rm -Rf $tmp_file
	fi
}

function pre_remove(){
	echo "Pre-remove $NAME $VERSION-$RELEASE ..."
	check_code $?
}

function post_remove(){
	echo "Post-remove $NAME $VERSION-$RELEASE ..."
	check_code $?
}

function pre_update(){
	echo "Pre-update $NAME $VERSION-$RELEASE ..."
	check_code $?
}

function post_update(){
	echo "Post-update $NAME $VERSION-$RELEASE ..."
	check_code $?
}

function purge(){
	echo "Purge $NAME $VERSION-$RELEASE ..."
	check_code $?
}
